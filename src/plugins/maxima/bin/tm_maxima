#!/bin/sh

TEXMACS_MAXIMA_PATH="$TEXMACS_PATH/plugins/maxima/lisp"
export TEXMACS_MAXIMA_PATH
PATH="/cygdrive/c/Program Files/Maxima-5.9.2/bin:$PATH"
PATH="/cygdrive/c/Program Files/Maxima-5.9.3/bin:$PATH"
export PATH

case $1 in
  5.6)
    case $2 in
      gcl) exec maxima -load "$TEXMACS_MAXIMA_PATH/texmacs-maxima-5.6.lisp" \
          | maxima_filter;;
      clisp) exec maxima -i "$TEXMACS_MAXIMA_PATH/texmacs-maxima-5.6.lisp" \
          | maxima_filter;;
      *) echo -e "\2latex:\\red Unsupported lisp for old maxima: $2\5"
    esac;;
  5.9.0) exec maxima -u $1 -l $2 -p "$TEXMACS_MAXIMA_PATH/texmacs-maxima-5.9.0.lisp" \
      | maxima_filter;;
  5.9.1) exec maxima -u $1 -l $2 -p "$TEXMACS_MAXIMA_PATH/texmacs-maxima-5.9.1.lisp";;
  5.9.1.1* | 5.9.2* | 5.9.3*) exec maxima -u $1 -l $2 -p "$TEXMACS_MAXIMA_PATH/texmacs-maxima-5.9.2.lisp";;
  5.10.*) exec maxima -u $1 -l $2 -p "$TEXMACS_MAXIMA_PATH/texmacs-maxima-5.10.0.lisp";;
  cygwin)
    CYGWIN_ROOT="C:\cygwin"
    CYGWIN_TEXMACS_HOME=`echo $TEXMACS_HOME_PATH | sed 's|/|\\\\|g'`
    export CYGWIN_TEXMACS_HOME
    cp -f "$TEXMACS_MAXIMA_PATH/texmacs-maxima-5.9.2.lisp" \
          "$CYGWIN_ROOT$CYGWIN_TEXMACS_HOME\system\tmp"
    exec maxima.bat -p \
      "$CYGWIN_ROOT$CYGWIN_TEXMACS_HOME\system\tmp\texmacs-maxima-5.9.2.lisp";;
  *) echo -e "\2latex:\\red Unsupported version of maxima: $1\5"
esac
